import type { Style } from '@dicebear/avatars';
import type { Options } from './options';
import type { ComponentPickCollection, ColorPickCollection } from './static-types';

import { schema } from './schema';
import { pickComponent } from './utils/pickComponent';
import { pickColor } from './utils/pickColor';

export const style: Style<Options> = {
  meta: {
    title: 'Open Peeps',
    creator: 'Pablo Stanley',
    source: 'https://www.openpeeps.com/',
    license: {
      name: 'CC0 1.0',
      url: 'https://creativecommons.org/publicdomain/zero/1.0/',
    },
  },
  schema,
  create: ({ prng, options }) => {
    const headComponent = pickComponent(prng, 'head', options.head);
    const faceComponent = pickComponent(prng, 'face', options.face);
    const facialHairComponent = pickComponent(prng, 'facialHair', options.facialHair);
    const maskComponent = pickComponent(prng, 'mask', options.mask);
    const accessoriesComponent = pickComponent(prng, 'accessories', options.accessories);

    const components: ComponentPickCollection = {
      'head': headComponent,
      'face': faceComponent,
      'facialHair': prng.bool(options.facialHairPropability) ? facialHairComponent : undefined,
      'mask': prng.bool(options.maskPropability) ? maskComponent : undefined,
      'accessories': prng.bool(options.accessoriesPropability) ? accessoriesComponent : undefined,
    }

    const colors: ColorPickCollection = {
      'skin': pickColor(prng, 'skin', options.skinColor ?? []),
      'clothing': pickColor(prng, 'clothing', options.clothingColor ?? []),
      'hair': pickColor(prng, 'hair', options.hairColor ?? []),
    }

    return {
      attributes: {
        viewBox: '0 0 704 704',
        fill: 'none',
      },
      body: `<g fill-rule="evenodd" clip-rule="evenodd"><path d="M705.281 1074.02a2351.117 2351.117 0 0 1-11.084-68.46c-1.594-10.86-3.149-21.73-4.547-32.618-.979-7.628-2.47-16.351 2.72-22 7.303-7.952 13.937-14.758 14.831-26.149.841-10.717-2.783-22.4-5.049-32.803-4.752-21.816-10.668-43.362-17.205-64.704-6.641-21.683-13.923-43.162-21.31-64.6-6.906-20.044-13.545-40.269-22.54-59.5-17.071-36.495-45.951-63.522-81.643-81.568-8.877-4.488-26.983-20.51-36.257-24.097-8.526-3.298-8.495 6.333-16.886 2.705-6.708-2.9-12.954-6.767-16.71-13.244-4.078-7.033-14.305-16.869-15.862-25.055-3.299-17.351.275-32.12-12.109-45.179-10.994-11.597-25.771-19.542-41.061-23.807-33.636-9.381-78.494-2.822-98.788 28.433-9.693 14.926-13.08 32.968-26.159 45.149-11.421 10.636-8.865 17.908-23.657 23.39-.838.311-23.546-4.56-24.384-4.248-16.182-3.463-31.648 6.23-46.494 11.856-22.133 8.384-43.205 19.298-63.002 32.269-39.92 26.155-74.11 60.118-102.296 98.551-28.42 38.75-50.471 82.182-66.172 127.576a492.842 492.842 0 0 0-10.26 33.455c-1.69 6.307-3.497 12.849-1.438 19.305 1.684 5.283 5.43 9.216 9.829 12.385 5.963 4.297 17.924 7.09 17.69 15.732-.177 6.57-2.406 13.485-3.494 19.978-1.295 7.732-2.36 15.51-3.423 23.276-4.84 35.352-8.607 70.902-10.273 106.552-1.64 35.1-3.001 70.92-.566 106.01.16 2.31.85 4.44 1.964 6.23-1.04.4-1.12 2.34.174 2.61.906.19 1.81.39 2.716.58 1.882 1.42 4.229 2.29 6.93 2.38 1.83.06 3.66.14 5.49.23 19.3 4.04 38.599 7.85 58.152 10.74 23.768 3.5 47.606 6.36 71.518 8.69 49.135 4.78 97.883 3.19 147.083.62 49.124-2.58 98.219-3.18 147.394-1.9 49.218 1.28 98.418 3.42 147.647 4.3 54.999.98 109.914-.52 164.754-4.9 7.519-.59 12.171-6.58 10.688-14.04-8.885-44.75-18.954-89.19-26.911-134.13Z" fill="${colors.skin.value}"/><path d="m201.087 597.521 1.074-.414c14.518-5.671 29.628-14.822 45.421-11.442.558-.208 10.834 1.887 17.872 3.215l-6.68 6.973-11.79 2.268c40.673 67.128 88.778 100.692 144.314 100.692 55.537 0 97.678-33.564 126.425-100.692l3.923-1.085c.484.112 1 .271 1.552.485 9.274 3.587 27.379 19.608 36.256 24.096 35.692 18.047 64.572 45.073 81.643 81.569 8.695 18.59 15.189 38.108 21.85 57.494l.69 2.005c7.387 21.438 14.669 42.918 21.31 64.601 6.253 20.414 11.938 41.015 16.579 61.86l.626 2.844c2.266 10.403 5.89 22.085 5.049 32.803-.318 4.058-1.365 7.534-2.912 10.687l-80.446 28.947 38.326 261.393c-35.107 1.51-70.246 1.9-105.419 1.27-49.229-.88-98.429-3.02-147.647-4.3-47.685-1.24-95.294-.71-142.928 1.67l-12.097.62c-46.613 2.33-92.858 3.52-139.452-1.01l-3.175-.31v-38.24l16.367-212.911-82.945-15.613-81.422-39.546c-2.46-2.459-4.434-5.329-5.532-8.773-1.907-5.98-.498-12.033 1.064-17.905l.375-1.4a492.842 492.842 0 0 1 10.26-33.455c15.7-45.394 37.751-88.827 66.171-127.576 28.187-38.433 62.377-72.396 102.296-98.552 19.797-12.97 40.869-23.884 63.002-32.268Z" fill="${colors.clothing.value}"/><path d="M232.235 584.564c5.086-.221 10.272.602 15.346 1.101.442.043.61.725.112.829-9.08 1.897-18.062 4.492-26.98 7.128l-3.819 1.13c-10.057 2.975-19.819 6.044-29.555 10.012-19.404 7.908-37.833 18.582-54.794 30.845C67.233 682.83 19.963 754.324-9.867 828.345a525.982 525.982 0 0 0-20.525 61.653 554.65 554.65 0 0 0-3.83 15.347c-.354 1.505-1.897 5.359-1.05 6.899.747 1.361 3.655 2.202 5.006 2.91l4.561 2.365c8.897 4.585 23.717 12.123 25.203 12.857l2.318 1.141c37.91 18.585 78.418 34.345 121.079 35.436l.334-3.643c1.902-20.141 4.398-40.389 9.846-59.911.293-1.049 1.628-.695 1.75.237 3.035 23.111 2.065 46.402 1.006 69.62-1.875 41.124-4.365 82.224-6.578 123.324-1.108 20.57-2.54 41.11-3.833 61.67-1.295 20.59-1.714 41.68-4.671 62.1-.659 4.55-5.991 7.03-10.029 6.55-4.468-.53-7.905-4.47-7.926-8.98-.054-11.9 1.441-23.94 2.272-35.8.789-11.28 1.636-22.55 2.504-33.82 3.172-41.13 6.821-82.21 10.196-123.33 1.196-14.58 2.488-29.147 3.818-43.715-45.193-1.457-87.414-18.196-127.692-37.754-.583 13.237-1.99 26.45-3.354 39.632-3.805 36.787-7.16 73.557-9.67 110.457-1.269 18.64-2.192 37.3-2.996 55.96a1708.912 1708.912 0 0 0-1.187 36.7l-.137 7.01c-.113 4.44-.564 8.55-4.3 11.78-3.796 3.29-8.922 3.46-12.678 0-5.028-4.63-4.139-10.93-3.99-17.15a1718.048 1718.048 0 0 1 1.775-47.18c1.886-36.64 5.655-73.13 10.58-109.47l1.922-14.03c3.59-26.08 7.532-52.754 15.558-77.877a1428.758 1428.758 0 0 1-9.345-4.691c-5.506-2.788-11.199-5.404-16.55-8.481-4.247-2.441-7.909-5.789-9.09-10.73-1.319-5.505.697-11.526 2.036-16.896l.116-.472a502.049 502.049 0 0 1 4.22-16.153c6.05-21.739 13.53-43.054 22.285-63.849 17.53-41.632 40.157-81.183 67.796-116.944 24.88-32.19 54.269-61.382 88.715-83.276 16.84-10.704 34.786-19.493 53.765-25.707 8.871-2.904 18.523-5.43 27.811-6.47 5.01-.56 10.027-.881 15.061-1.1Zm90.114-65.97c6.044-6.49 18.052.226 15.15 8.82-6.826 20.219-17.696 38.662-34.66 51.948-15.946 12.49-34.961 20.601-55.439 18.87a1.217 1.217 0 0 1-.416-.111l1.765 2.394c13.854 18.741 28.47 37.223 46.087 52.541 35.893 31.211 84.763 48.045 131.953 36.07 37.128-9.421 69.838-38.78 79.458-76.196-1.379.618-3.018.829-4.817.438-7.697-1.671-15.317-9.766-20.281-15.57-5.37-6.279-9.564-13.059-12.638-20.723-5.626-14.026-7.43-32.085.252-45.672.948-1.675 3.134-.736 3.32.899l.292 2.552c1.481 12.734 3.326 25.051 9.33 36.659 2.938 5.68 6.46 11.224 10.747 15.981 2.294 2.545 4.781 4.977 7.466 7.111 2.616 2.079 5.783 3.583 8.128 5.968l.43.458.012-.082c.593-5.041 4.128-7.262 7.587-7.123 3.347.135 7.279 1.608 8.802 2.314l.144.068c23.352 11.21 44.859 25.821 65.099 42.031 41.856 33.524 73.217 77.349 88.412 128.957 7.458 25.329 11.737 51.428 16.254 77.405l2.782 15.917c4.216 23.981 8.926 48.435 18.444 70.743 2.462 5.771.564 11.183-5.473 13.452-7.538 2.834-15.104 5.578-22.682 8.288 3.721 15.963 5.99 32.479 8.778 48.519 5.926 34.1 13.187 67.98 19.413 102.04 3.183 17.41 6.055 34.88 9.235 52.29 1.531 8.39 3.129 16.76 4.683 25.14.837 4.52 1.596 9.06 2.395 13.58l.139.76c.458 2.38 1.033 4.85.376 7.24-.749 2.73-2.876 4.65-4.775 6.61-1.563 1.61-3.822 1.62-5.737.74l-.63-.29c-3.42-1.6-6.1-3.2-7.313-7.06-.768-2.44-1.045-5.19-1.547-7.71-.963-4.82-1.876-9.66-2.738-14.5a3535.65 3535.65 0 0 1-5.052-29.1l-1.536-9.09c-5.27-31.33-10.275-62.85-12.805-94.51-1.123-14.05-2.312-28.08-3.513-42.12l-.901-10.524c-1.14-13.325-2.533-26.987-2.73-40.492l-4.532 1.609-22.11 7.816c-5.482 1.937-12.462 5.907-18.362 5.185-2.888-.354-5.09-1.263-6.79-2.915 2.036 28.733 4.792 57.421 8.465 85.951 3.342 25.97 7.047 51.9 11.423 77.71 2.167 12.78 4.394 25.55 6.813 38.29 1.209 6.37 2.457 12.73 3.743 19.08.641 3.17 1.404 6.35 1.904 9.54.572 3.66-.436 5.91-2.481 8.93-1.679 2.47-5.038 3.74-7.761 2.03-3.606-2.26-5.487-4.22-6.548-8.34-.964-3.75-1.55-7.65-2.296-11.44-1.377-7-2.708-14.01-3.993-21.02-2.687-14.68-5.164-29.38-7.376-44.14-7.795-51.97-12.741-104.37-15.239-156.859-1.233-25.897-1.614-51.817-1.395-77.741.112-13.288.546-26.614 1.486-39.869.952-13.417 2.932-26.566 4.7-39.854.062-.468.722-.495.75 0 .837 14.898 2.149 29.779 2.792 44.716.614 14.253.883 28.528 1.371 42.786.641 18.742 1.53 37.495 2.707 56.235 2.131-2.331 5.343-3.675 8.557-3.15 4.656-.977 9.668-3.42 14.107-4.903l16.734-5.59c8.797-2.938 17.594-5.856 26.422-8.686-7.893-26.553-13.3-53.502-17.917-80.844l-2.059-12.297c-4.075-24.204-8.47-48.419-15.852-71.858-7.761-24.642-19.375-47.552-34.782-68.299-15.187-20.447-33.664-38.451-52.688-55.291-16.287-14.416-33.71-27.432-50.322-41.452.174.929.211 1.952.058 3.076-3.532 25.85-17.017 49.923-35.81 67.828-37.755 35.971-93.642 43.434-141.964 26.566-46.743-16.316-88.07-54.958-102.671-102.775-.25-.818.846-1.143 1.286-.542.81 1.11 1.624 2.22 2.439 3.33-.055-.441.174-.921.718-1.131 17.036-6.578 33.765-15.907 46.535-29.104 6.224-6.433 11.656-13.721 15.944-21.581 2.054-3.765 3.899-7.664 5.371-11.693l.374-1.042c1.784-5.047 3.275-10.193 6.999-14.192Z" fill="#000"/></g><g transform="matrix(.99789 0 0 1 156 62)">${components.head?.value(components, colors) ?? ''}</g><g transform="translate(315 248)">${components.face?.value(components, colors) ?? ''}</g><g transform="translate(279 400)">${components.facialHair?.value(components, colors) ?? ''}</g><g transform="translate(179 343)">${components.mask?.value(components, colors) ?? ''}</g><g transform="translate(203 303)">${components.accessories?.value(components, colors) ?? ''}</g>`,
    };
  },
};
